# Weather App

A small full-stack Weather application. The app has two main pages:

- Location page: shows location information (population, country, latitude & longitude), an interactive map, and a short fun fact generated by an AI helper.
- Weather page: shows detailed weather information (forecast, current conditions) and includes an AI chatbot you can ask about the weather, safety precautions, and context-aware advice.

## Tech stack

- Client: React (Create React App), Tailwind CSS
- Server: Node.js + Express
- APIs used:
  - GeoNames for location lookup
  - WeatherAPI (weatherapi.com) for forecast data
  - OpenAI (optional) for AI-generated fun facts and chat responses

## Project structure (important files)

- `client/` — React frontend
  - `src/` — source files
  - `src/components/` — UI components
  - `src/pages/` — routing pages
  - `client/.env` or `client/src/.env` — any client-specific env vars (if used)

- `server/` — Express backend
  - `server/app.js` — server entry (loads `.env`)
  - `server/controllers/getDataController.js` — location and weather controllers
  - `server/controllers/llmController.js` — AI/chat handling (requires OpenAI key)
  - `server/routes/getData.js` — route wiring
  - `server/.env` — secrets and API keys

## Environment variables

Create a `.env` file in `server/` (this repo includes an example). At minimum set:

```
PORT=5000
USERNAME_KEY=your_geonames_username
WEATH_API=your_weatherapi_key
OPENAI_API_KEY=your_openai_api_key   # optional (only needed for AI features)
```

Notes:
- `USERNAME_KEY` is the GeoNames username used for location lookup.
- `WEATH_API` is the WeatherAPI key used to fetch forecasts.
- `OPENAI_API_KEY` powers AI-generated fun facts and the chatbot — leave out if you don't need AI features, but the server will log a warning/error if missing.

## Run locally

1. Server

```bash
cd server
# install dependencies if you haven't
npm install
# start server
node app.js
# or with nodemon
npx nodemon app.js
```

The server listens on the port specified in `server/.env` (e.g. `PORT=5000`). The keep-alive endpoint is:

```
GET /keep-alive
```

2. Client

```bash
cd client
npm install
npm start
```

The client defaults to `http://localhost:3000` and the server origin is expected at `http://localhost:5000` unless you change CORS/ENV settings.

## API Endpoints (server)

- `POST /getdata/input` — accepts `{ locName }` to return location suggestions from GeoNames.
- `POST /getdata/loc` — accepts `{ location: [...] }` (an array describing the selected place) and returns detailed location + weather.
- `POST /getdata/weather` — accepts `{ location: [...] }` and returns weather data directly from WeatherAPI.

(Exact route names reflect the app's `server/routes/getData.js` wiring.)

## Troubleshooting

- If `process.env.USERNAME_KEY` is `undefined` in `getDataController.js`, ensure `require('dotenv').config()` runs before routes are required — this project loads dotenv at the top of `server/app.js`.
- If you see an OpenAI "Missing credentials" error on startup, add `OPENAI_API_KEY` to `server/.env` or guard the LLM controller to skip AI calls when no key is present.
- `server/package.json` `start` script may point to `index.js` by default; start the app with `node app.js` or update the script to `node app.js`.

## Deployment

- Ensure the production environment has the same environment variables set (USERNAME_KEY, WEATH_API, OPENAI_API_KEY if used).
- The client build is under `client/build` (or `build/` at repo root if prebuilt). Serve that as static assets or deploy the client separately (Vercel, Netlify).
- For the server, deploy to any Node host (Heroku, Render, Railway, etc.) and set env vars in the host dashboard.

## Development notes

- Controllers currently read some env vars at module scope. If you prefer, move those reads into handlers so they pick up environment changes at runtime.
- The AI features are optional — they provide fun facts on the Location page and power the Weather chat assistant.

## Contributing

PRs welcome. For bigger changes, open an issue first describing the change.

## License

Add your preferred license.
